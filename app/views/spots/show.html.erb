<div class="container px-5 my-5 px-sm-0">
  <div class="row">
    <div class="col-sm-12 col-md-10 col-lg-8 px-5 px-sm-0 mx-auto">
      <h3><%= @spot.address %>の詳細情報</h3>
      <div id="show_map"></div>
      <div class="text-center mb-3">
        <h5>レビュー <%= @reviews.count %>件</h5>
        <span id="rate_<%= @spot.id %>"></span>
        <%= render "reviews/rate_avg", spot: @spot, reviews: @reviews %>
        <span><%= @reviews.average(:rate).to_f.round(1) %></span>
      </div>
      <table class="table mb-5">
        <% @reviews.each do |review| %>
          <tr>
            <td style= "width:20%" class="align-middle">
              <%= attachment_image_tag review.user, :profile_image, size: "50x50", fallback: "cheer.jpeg", style: "border-radius: 50%" %>
              <%= review.user.name %>
            </td>
            <td style= "width:80%" class="align-middle">
              <%= safe_join(review.body.split("\n"),tag(:br)) %>
            </td>
          </tr>
        <% end %>
      </table>
      <%= form_with model: @review, local:true do |f| %>
        <div class="form-group">
          <%= f.hidden_field :spot_id, value: @spot.id %>
          <%= f.hidden_field :user_id, value: current_user.id %>
          <%= f.text_area :body, placeholder: "レビューを入力してください", class: "form-control", rows: "3" %>
        </div>
        <div class="form-group text-center" id="star">
          <%= f.label :rate, "評価" %>
          <%= f.hidden_field :rate, id: :review_star %>
          <%= render "reviews/rate" %>
        </div>
        <div class="form-group text-center">
          <%= f.submit "レビューを投稿", class: "btn btn-success" %>
        </div>
      <% end %>
    </div>
  </div>
</div>
<%= javascript_include_tag "googlemap.js" %>